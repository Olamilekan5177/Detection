{% extends 'dashboard/base.html' %} {% load static %} {% load math_filters %} {% block title %}Analytics
- Oil Spill Detection{% endblock %} {% block content %}
<style>
  body,
  .page-container {
    background: linear-gradient(135deg, #f8fafb 0%, #eef2f5 100%);
  }

  .analytics-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 30px;
    gap: 20px;
  }

  .page-title {
    color: #111827;
    font-size: 2.2em;
    font-weight: 800;
    display: flex;
    align-items: center;
    gap: 15px;
  }

  .time-selector {
    display: flex;
    gap: 10px;
  }

  .time-btn {
    padding: 10px 16px;
    background: linear-gradient(135deg, #ffffff 0%, #f9fafb 100%);
    border: 2px solid #d1d5db;
    border-radius: 8px;
    color: #374151;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s;
  }

  .time-btn:hover {
    border-color: #3b82f6;
    color: #3b82f6;
  }

  .time-btn.active {
    background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
    border-color: #2563eb;
    color: white;
  }

  .stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
  }

  .stat-card {
    background: linear-gradient(135deg, #ffffff 0%, #f9fafb 100%);
    border: 2px solid #e5e7eb;
    border-radius: 12px;
    padding: 25px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
    transition: all 0.3s;
  }

  .stat-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.12);
  }

  .stat-label {
    color: #6b7280;
    font-size: 0.9em;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-bottom: 8px;
  }

  .stat-value {
    font-size: 2.5em;
    font-weight: 800;
    color: #111827;
  }

  .stat-unit {
    color: #9ca3af;
    font-size: 0.4em;
    margin-left: 5px;
  }

  .stat-trend {
    font-size: 0.85em;
    margin-top: 8px;
    color: #059669;
  }

  .chart-container {
    background: linear-gradient(135deg, #ffffff 0%, #f9fafb 100%);
    border: 2px solid #e5e7eb;
    border-radius: 12px;
    padding: 30px;
    margin-bottom: 30px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
  }

  .chart-title {
    color: #111827;
    font-size: 1.3em;
    font-weight: 700;
    margin-bottom: 20px;
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .severity-list {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 15px;
  }

  .severity-item {
    padding: 20px;
    border-radius: 10px;
    text-align: center;
    border: 2px solid;
  }

  .severity-low {
    background: #f0fdf4;
    border-color: #22c55e;
    color: #15803d;
  }

  .severity-medium {
    background: #fffbeb;
    border-color: #f59e0b;
    color: #92400e;
  }

  .severity-high {
    background: #fef2f2;
    border-color: #ef4444;
    color: #b91c1c;
  }

  .severity-critical {
    background: #7c2d12;
    border-color: #ea580c;
    color: white;
  }

  .severity-count {
    font-size: 2em;
    font-weight: 800;
    display: block;
    margin-bottom: 5px;
  }

  .severity-label {
    font-size: 0.9em;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  .no-data {
    text-align: center;
    padding: 60px 20px;
    color: #9ca3af;
  }

  .no-data-icon {
    font-size: 3em;
    margin-bottom: 15px;
  }

  .no-data-text {
    font-size: 1.1em;
    font-weight: 600;
  }
</style>

<div style="color: #1f2937; padding: 20px 0">
  <!-- Header -->
  <div class="analytics-header">
    <div class="page-title">üìä Analytics & Reports</div>
    <div class="time-selector">
      <a href="?days=7" class="time-btn {% if days == 7 %}active{% endif %}"
        >7 Days</a
      >
      <a href="?days=30" class="time-btn {% if days == 30 %}active{% endif %}"
        >30 Days</a
      >
      <a href="?days=90" class="time-btn {% if days == 90 %}active{% endif %}"
        >90 Days</a
      >
    </div>
  </div>

  <!-- Key Statistics -->
  <div class="stats-grid">
    <div class="stat-card">
      <div class="stat-label">üìç Total Detections</div>
      <div class="stat-value">
        {{ total_in_period }}<span class="stat-unit">events</span>
      </div>
      <div class="stat-trend">in last {{ days }} days</div>
    </div>

    <div class="stat-card">
      <div class="stat-label">‚õî Critical Cases</div>
      <div class="stat-value">
        {% for item in severity_trend %} {% if item.severity == 'CRITICAL' %}{{
        item.count }}{% endif %} {% empty %}0{% endfor %}<span class="stat-unit"
          >cases</span
        >
      </div>
      <div class="stat-trend">require immediate action</div>
    </div>

    <div class="stat-card">
      <div class="stat-label">üî¥ High Severity</div>
      <div class="stat-value">
        {% for item in severity_trend %} {% if item.severity == 'HIGH' %}{{
        item.count }}{% endif %} {% empty %}0{% endfor %}<span class="stat-unit"
          >cases</span
        >
      </div>
      <div class="stat-trend">monitoring required</div>
    </div>

    <div class="stat-card">
      <div class="stat-label">‚è±Ô∏è Detection Rate</div>
      <div class="stat-value">
        {% if total_in_period > 0 %}{{ days|add:0 }}{% else %}0{% endif %}<span
          class="stat-unit"
          >/{{ days }}</span
        >
      </div>
      <div class="stat-trend">per day average</div>
    </div>
  </div>

  <!-- Severity Distribution -->
  <div class="chart-container">
    <div class="chart-title">üéØ Detection Distribution by Severity</div>

    {% if severity_trend %}
    <div class="severity-list">
      {% for item in severity_trend %}
      <div class="severity-item severity-{{ item.severity|lower }}">
        <span class="severity-count">{{ item.count }}</span>
        <span class="severity-label">{{ item.severity }}</span>
      </div>
      {% endfor %}
    </div>
    {% else %}
    <div class="no-data">
      <div class="no-data-icon">üì≠</div>
      <div class="no-data-text">No detections in the past {{ days }} days</div>
    </div>
    {% endif %}
  </div>

  <!-- Summary -->
  <div class="chart-container">
    <div class="chart-title">üìà Summary</div>
    <div style="line-height: 1.8; color: #374151">
      <p>
        <strong style="color: #111827">Time Period:</strong> Last {{ days }}
        days
      </p>
      <p>
        <strong style="color: #111827">Total Events:</strong> {{ total_in_period
        }} oil spill detections
      </p>
      {% if total_in_period > 0 %}
      <p>
        <strong style="color: #111827">Status:</strong>
        <span style="color: #ef4444">‚ö†Ô∏è Active monitoring required</span>
      </p>
      <p
        style="
          margin-top: 15px;
          padding-top: 15px;
          border-top: 1px solid #e5e7eb;
        "
      >
        View detailed detection data on the
        <a
          href="/dashboard/map/"
          style="color: #3b82f6; text-decoration: none; font-weight: 600"
          >Map View</a
        >
        or check
        <a
          href="/dashboard/monitoring/"
          style="color: #3b82f6; text-decoration: none; font-weight: 600"
          >Live Monitoring</a
        >
        for real-time updates.
      </p>
      {% else %}
      <p>
        <strong style="color: #111827">Status:</strong>
        <span style="color: #10b981">‚úÖ No active spill detections</span>
      </p>
      {% endif %}
    </div>
  </div>
</div>
{% endblock %}
