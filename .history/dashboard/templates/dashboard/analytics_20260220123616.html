{% extends 'dashboard/base.html' %} {% load static %} {% block title %}Analytics - Oil Spill Detection{% endblock %} {% block content %}
<div style="color: #1f2937; padding: 20px 0">
  <div class="page-title" style="color: #111827; font-size: 2.2em; font-weight: 800; margin-bottom: 30px;">ğŸ“Š Analytics & Reports</div>
  <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 20px; margin-bottom: 30px;">
    <div style="background: white; border: 2px solid #e5e7eb; border-radius: 12px; padding: 25px; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);">
      <div style="color: #6b7280; font-size: 0.9em; font-weight: 600; text-transform: uppercase; margin-bottom: 8px;">ğŸ“ Total Detections</div>
      <div style="font-size: 2.5em; font-weight: 800; color: #111827;">{{ total_in_period }}<span style="color: #9ca3af; font-size: 0.4em; margin-left: 5px">events</span></div>
      <div style="font-size: 0.85em; margin-top: 8px; color: #059669;">in last {{ days }} days</div>
    </div>
    <div style="background: white; border: 2px solid #e5e7eb; border-radius: 12px; padding: 25px; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);">
      <div style="color: #6b7280; font-size: 0.9em; font-weight: 600; text-transform: uppercase; margin-bottom: 8px;">â›” Critical Cases</div>
      <div style="font-size: 2.5em; font-weight: 800; color: #111827;">{% for item in severity_trend %}{% if item.severity == 'CRITICAL' %}{{ item.count }}{% endif %}{% empty %}0{% endfor %}<span style="color: #9ca3af; font-size: 0.4em; margin-left: 5px">cases</span></div>
      <div style="font-size: 0.85em; margin-top: 8px; color: #059669;">require immediate action</div>
    </div>
    <div style="background: white; border: 2px solid #e5e7eb; border-radius: 12px; padding: 25px; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);">
      <div style="color: #6b7280; font-size: 0.9em; font-weight: 600; text-transform: uppercase; margin-bottom: 8px;">ğŸ”´ High Severity</div>
      <div style="font-size: 2.5em; font-weight: 800; color: #111827;">{% for item in severity_trend %}{% if item.severity == 'HIGH' %}{{ item.count }}{% endif %}{% empty %}0{% endfor %}<span style="color: #9ca3af; font-size: 0.4em; margin-left: 5px">cases</span></div>
      <div style="font-size: 0.85em; margin-top: 8px; color: #059669;">monitoring required</div>
    </div>
    <div style="background: white; border: 2px solid #e5e7eb; border-radius: 12px; padding: 25px; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);">
      <div style="color: #6b7280; font-size: 0.9em; font-weight: 600; text-transform: uppercase; margin-bottom: 8px;">ğŸ“ˆ Medium Severity</div>
      <div style="font-size: 2.5em; font-weight: 800; color: #111827;">{% for item in severity_trend %}{% if item.severity == 'MEDIUM' %}{{ item.count }}{% endif %}{% empty %}0{% endfor %}<span style="color: #9ca3af; font-size: 0.4em; margin-left: 5px">cases</span></div>
      <div style="font-size: 0.85em; margin-top: 8px; color: #059669;">monitoring recommended</div>
    </div>
  </div>
  <div style="background: white; border: 2px solid #e5e7eb; border-radius: 12px; padding: 30px; margin-bottom: 30px; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);">
    <div style="color: #111827; font-size: 1.3em; font-weight: 700; margin-bottom: 20px;">ğŸ¯ Detection Distribution by Severity</div>
    {% if severity_trend %}
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px;">
      {% for item in severity_trend %}
      <div style="padding: 20px; border-radius: 10px; text-align: center; border: 2px solid; {% if item.severity == 'LOW' %}background: #f0fdf4; border-color: #22c55e; color: #15803d;{% elif item.severity == 'MEDIUM' %}background: #fffbeb; border-color: #f59e0b; color: #92400e;{% elif item.severity == 'HIGH' %}background: #fef2f2; border-color: #ef4444; color: #b91c1c;{% elif item.severity == 'CRITICAL' %}background: #7c2d12; border-color: #ea580c; color: white;{% endif %}">
        <span style="font-size: 2em; font-weight: 800; display: block; margin-bottom: 5px;">{{ item.count }}</span>
        <span style="font-size: 0.9em; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px;">{{ item.severity }}</span>
      </div>
      {% endfor %}
    </div>
    {% else %}
    <div style="text-align: center; padding: 60px 20px; color: #9ca3af"><div style="font-size: 3em; margin-bottom: 15px">ğŸ“­</div><div style="font-size: 1.1em; font-weight: 600">No detections in the past {{ days }} days</div></div>
    {% endif %}
  </div>
  <div style="background: white; border: 2px solid #e5e7eb; border-radius: 12px; padding: 30px; margin-bottom: 30px; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);">
    <div style="color: #111827; font-size: 1.3em; font-weight: 700; margin-bottom: 20px;">ğŸ“‹ Recent Detections</div>
    <div style="overflow-x: auto">
      <table style="width: 100%; border-collapse: collapse; font-size: 0.9em">
        <thead>
          <tr style="border-bottom: 2px solid #e5e7eb">
            <th style="padding: 12px; text-align: left; color: #6b7280; font-weight: 600;">ID</th>
            <th style="padding: 12px; text-align: left; color: #6b7280; font-weight: 600;">Date</th>
            <th style="padding: 12px; text-align: left; color: #6b7280; font-weight: 600;">Location</th>
            <th style="padding: 12px; text-align: left; color: #6b7280; font-weight: 600;">Severity</th>
            <th style="padding: 12px; text-align: left; color: #6b7280; font-weight: 600;">Confidence</th>
            <th style="padding: 12px; text-align: left; color: #6b7280; font-weight: 600;">Area (kmÂ²)</th>
          </tr>
        </thead>
        <tbody>
          {% for detection in recent_detections %}
          <tr style="border-bottom: 1px solid #e5e7eb">
            <td style="padding: 12px; color: #111827">#{{ detection.id }}</td>
            <td style="padding: 12px; color: #374151; font-size: 0.85em">{{ detection.detection_date|date:"M d, Y H:i" }}</td>
            <td style="padding: 12px; color: #374151; font-family: monospace; font-size: 0.85em;">{{ detection.latitude|floatformat:4 }}, {{ detection.longitude|floatformat:4 }}</td>
            <td style="padding: 12px"><span style="background-color: {% if detection.severity == 'CRITICAL' %}#7c2d12{% elif detection.severity == 'HIGH' %}#ef4444{% elif detection.severity == 'MEDIUM' %}#f59e0b{% else %}#22c55e{% endif %}; color: white; padding: 4px 8px; border-radius: 4px; font-weight: 600; font-size: 0.85em;">{{ detection.severity }}</span></td>
            <td style="padding: 12px; color: #374151">{{ detection.confidence_score|floatformat:1 }}%</td>
            <td style="padding: 12px; color: #374151">{{ detection.area_km2|floatformat:2 }} kmÂ²</td>
          </tr>
          {% empty %}
          <tr><td colspan="6" style="padding: 20px; text-align: center; color: #9ca3af;"><div style="font-size: 1.1em">No detections found</div></td></tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>
{% endblock %}
